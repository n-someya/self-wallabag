





specify.md

```
---
description: 自然言語による機能説明から、機能仕様書を作成または更新します。
---

与えられた機能説明（引数）に基づいて、以下を実行してください：

1. リポジトリのルートから `.specify/scripts/bash/create-new-feature.sh --json "$ARGUMENTS"` を実行し、そのJSON出力から BRANCH_NAME と SPEC_FILE を取得します。すべてのファイルパスは絶対パスでなければなりません。
  **重要** このスクリプトは必ず一度だけ実行してください。JSONはターミナルの出力として提供されるので、常にそれを参照して必要な内容を取得してください。
2. `.specify/templates/spec-template.md` を読み込み、必要なセクションを確認します。
3. テンプレート構造を使い、プレースホルダーを機能説明（引数）から得られる具体的な内容に置き換えつつ、セクションの順序と見出しを保持して SPEC_FILE に仕様書を書き込みます。
4. ブランチ名、仕様書ファイルのパス、次のフェーズへの準備完了を報告してください。

注意: スクリプトは新しいブランチの作成とチェックアウト、仕様書ファイルの初期化を事前に行います。
```


constitution.md

```
---
description: 対話的または提供された原則入力からプロジェクト憲章を作成・更新し、すべての依存テンプレートが同期されるようにします。
# （スクリプトセクションなし：憲章の編集はエージェントによる手動支援で行います）
---

あなたは `.specify/memory/constitution.md` のプロジェクト憲章を更新しています。このファイルはテンプレートであり、角括弧（例: `[PROJECT_NAME]`, `[PRINCIPLE_1_NAME]`）のプレースホルダーが含まれています。あなたの役割は (a) 具体的な値を収集・導出し、(b) テンプレートを正確に埋め、(c) 変更を依存する成果物全体に反映することです。

実行フローは以下の通りです：

1. 憲章テンプレート `.specify/memory/constitution.md` を読み込みます。
   - `[ALL_CAPS_IDENTIFIER]` 形式のすべてのプレースホルダーを特定します。
   **重要**: ユーザーがテンプレートで使われている原則数より多い/少ない数を要求する場合があります。その場合は指定された数に従い、一般的なテンプレートをもとにドキュメントを更新してください。

2. プレースホルダーの値を収集・導出します：
   - ユーザー入力（会話）で値が提供されていればそれを使います。
   - それ以外はリポジトリの既存コンテキスト（README、ドキュメント、過去の憲章バージョンなど）から推測します。
   - ガバナンス日付について：`RATIFICATION_DATE` は最初の採択日（不明なら質問またはTODOを記載）、`LAST_AMENDED_DATE` は変更があれば今日の日付、なければ前回のまま。
   - `CONSTITUTION_VERSION` はセマンティックバージョニング規則に従って増分します：
     * MAJOR: 後方互換性のないガバナンス/原則の削除や再定義
     * MINOR: 新しい原則/セクションの追加や大幅なガイダンス拡張
     * PATCH: 明確化、文言修正、誤字修正、非意味的な改良
   - バージョンアップの種類が曖昧な場合は、理由を提案してから最終決定してください。

3. 更新された憲章内容を作成します：
   - すべてのプレースホルダーを具体的なテキストに置き換えます（プロジェクトが未定義としたテンプレート枠以外は角括弧を残さない—残す場合は明確な理由を記載）。
   - 見出し階層を保持し、コメントは置換後に不要なら削除します（補足説明として残す場合を除く）。
   - 各原則セクション：簡潔な名称行、譲れないルールを記載した段落（または箇条書き）、明確でない場合は明示的な根拠も記載。
   - ガバナンスセクションには改正手続き、バージョン管理方針、遵守レビューの期待事項を記載。

4. 一貫性伝播チェックリスト（以前のチェックリストをアクティブな検証に変換）：
   - `.specify/templates/plan-template.md` を読み、"Constitution Check" やルールが更新された原則と一致しているか確認。
   - `.specify/templates/spec-template.md` を読み、範囲/要件が一致しているか—憲章で必須セクションや制約が追加/削除された場合は更新。
   - `.specify/templates/tasks-template.md` を読み、タスク分類が新規または削除された原則駆動型タスクタイプ（例：可観測性、バージョニング、テスト規律）を反映しているか確認。
   - `.specify/templates/commands/*.md` 内の各コマンドファイル（このファイルも含む）を読み、古い参照（CLAUDEなどエージェント固有名）が残っていないか確認し、汎用ガイダンスが必要な場合は更新。
   - 実行時ガイダンスドキュメント（例：`README.md`、`docs/quickstart.md`、エージェント固有ガイダンスファイルなど）があれば読み、変更された原則への参照を更新。

5. 同期インパクトレポートを作成（更新後、憲章ファイルの先頭にHTMLコメントとして追加）：
   - バージョン変更：旧 → 新
   - 変更された原則一覧（旧タイトル → 新タイトル、名称変更時）
   - 追加セクション
   - 削除セクション
   - 更新が必要なテンプレート（✅ 更新済 / ⚠ 未対応）とファイルパス
   - 意図的に保留したプレースホルダーがあればTODOとして記載

6. 最終出力前の検証：
   - 未説明の角括弧トークンが残っていないこと
   - バージョン行がレポートと一致していること
   - 日付はISO形式 YYYY-MM-DD
   - 原則は宣言的・検証可能で曖昧な表現（"should" など）は避け、必要に応じて MUST/SHOULD の根拠を明記

7. 完成した憲章を `.specify/memory/constitution.md` に書き戻す（上書き）。

8. ユーザーへの最終サマリー出力：
   - 新バージョンとバージョンアップ理由
   - 手動対応が必要なファイル
   - 推奨コミットメッセージ（例：`docs: amend constitution to vX.Y.Z (principle additions + governance update)`）

フォーマット・スタイル要件：
- 見出しはテンプレート通り（階層変更不可）
- 長い根拠文は可読性を保つよう折り返し（100文字未満目安、無理な改行は不要）
- セクション間は空行1つ
- 末尾の空白は避ける

ユーザーが部分的な更新（例：原則1つのみ修正）を指定した場合も、検証とバージョン決定ステップは必ず実施。

重要情報が欠落している場合（例：採択日が本当に不明）、`TODO(<FIELD_NAME>): 説明` を挿入し、同期インパクトレポートの保留項目に記載。

新しいテンプレートは作成せず、必ず既存の `.specify/memory/constitution.md` ファイルを操作してください。
```